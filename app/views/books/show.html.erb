<p id="notice"><%= notice %></p>

<script type = "text/javascript">

$(document).ready(function() {
    $('div').onclick(function() {
        $('div').getSelectionText();
    });
});

function getSelectionText() {
    var text = "";
    if (window.getSelection) {
        text = window.getSelection().toString();
    } else if (document.selection && document.selection.type != "Control") {
        text = document.selection.createRange().text;
    }
	
	var str = document.URL;
	
	str = str.replace(/\?highlight\=/g, '');
	
	if (str.indexOf("?highlight=") != -1) {
		str = str.split("?highlight=")[0];
	}
	
	window.location.href = str + "?highlight=" + text;
	
    return text;
}

function selectText(element) {
    var doc = document
        , text = doc.getElementById(element)
        , range, selection
    ;    
    if (doc.body.createTextRange) { //ms
        range = doc.body.createTextRange();
        range.moveToElementText(text);
        range.select();
    } else if (window.getSelection) { //all others
        selection = window.getSelection();        
        range = doc.createRange();
        range.selectNodeContents(text);
        selection.removeAllRanges();
        selection.addRange(range);
    }
}
</script>

<p>
  <h1><%= @book.title %></h1>
  
</p>

<p>
  <h2><%= @book.author %></h2>
  
</p>

<p>
  <%= simple_format(@book.content) %>
</p>

<%= link_to_function 'Get Text!', "getSelectionText()" %> </br>
<%= link_to 'Annotate!', :action => "create_annotation", :method => :get%>

<h2>Annotations for this book:</h2>
<% @book.annotations.each do |a| %>
<%= render a %>
<% end %>

</br>

</br>

<%= link_to 'Edit', edit_book_path(@book) %> |
<%= link_to 'Back', books_path %>
